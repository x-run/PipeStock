# PRD - Product Requirements Document

## 1. 目的

倉庫内の在庫を正確に把握し、入出庫と引当を管理するための在庫管理システム MVP を構築する。

## 2. MVP 範囲

### In Scope

- 商品マスタの CRUD
- 在庫トランザクション (IN / OUT / ADJUST) の記録
- バケット (ON_HAND / RESERVED) ごとの在庫計算
- Available (= On-hand - Reserved) の自動算出
- 出庫時の Available 不足バリデーション
- 数量中心のダッシュボード

### Out of Scope (MVP 以降)

- 複数倉庫対応
- ロケーション管理 (棚番)
- バーコード / QR スキャン
- ロット管理 / シリアル管理
- ユーザー認証・権限管理
- 外部システム連携 (ERP / EC)
- レポート・分析機能

## 3. ユーザーストーリー

| ID | ストーリー | 優先度 |
|----|-----------|--------|
| US-1 | 倉庫担当者として、商品を登録・編集したい | Must |
| US-2 | 倉庫担当者として、入庫を記録して On-hand を増やしたい | Must |
| US-3 | 倉庫担当者として、出庫を記録して On-hand を減らしたい | Must |
| US-4 | 倉庫担当者として、引当を記録して Reserved を増やしたい | Must |
| US-5 | 倉庫担当者として、引当解除 (出荷完了) で Reserved を減らし On-hand も減らしたい | Must |
| US-6 | 倉庫担当者として、棚卸差異を ADJUST で補正したい | Must |
| US-7 | 管理者として、全商品の在庫状況を一覧で確認したい | Must |
| US-8 | 管理者として、発注点を下回った商品を把握したい | Should |

## 4. 優先度定義

1. **数量** - 在庫数量の正確性が最も重要
2. **単価** - 在庫金額の算出 (数量 x 単価)
3. **重量** - 物流計画の補助情報 (数量 x 単位重量)

## 5. Assumptions (前提・推測事項)

> 以下は明示的な要件定義がなかったため、本 MVP で仮定した事項です。
> 実装前にステークホルダーと確認してください。

| ID | 仮定 | 根拠 |
|----|------|------|
| A-1 | 通貨は日本円 (JPY) のみとする | 単一倉庫のため国内運用を想定 |
| A-2 | 単価は商品マスタの固定値を使用し、Tx ごとの単価変動は扱わない | MVP では簡潔さを優先 |
| A-3 | 重量単位は kg で統一する | 換算の複雑性を避ける |
| A-4 | 削除は論理削除 (active フラグ) とする | 商品に紐づく Tx 履歴を保全するため |
| A-5 | 同時実行制御は楽観ロック (version カラム) で対応する | MVP 規模では十分と判断 |
| A-6 | 認証は MVP 範囲外とし、単一ユーザー前提で構築する | スコープ限定のため |
| A-7 | Tx は作成のみ可能で、更新・削除は不可 (イミュータブル) | 在庫整合性を担保するため |
| A-8 | ADJUST Tx は ON_HAND バケットのみに適用可能とする | Reserved の補正は業務的に不自然なため |
